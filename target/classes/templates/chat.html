<!DOCTYPE html>
<html lang="pt-BR" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width, initial-scale=1"/>
    <title>Moris — IA Agent (Chat)</title>

    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet"/>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css" rel="stylesheet"/>

    <link th:href="@{/css/app.css}" rel="stylesheet"/>
</head>
<body class="bg-body">
<nav class="navbar navbar-dark bg-dark fixed-top">
    <div class="container-fluid">
        <a class="navbar-brand fw-semibold" href="#">
            <i class="bi bi-stars me-2"></i>Moris — IA Agent
        </a>
        <span class="badge text-bg-secondary">beta</span>
    </div>
</nav>

<main class="container-fluid chat-layout">
    <div class="row h-100 g-0">
        <aside class="col-12 col-md-4 col-lg-3 sidebar">
            <div class="sidebar-header-top d-flex align-items-center justify-content-between px-3 py-2">
                <button id="newChatBtn"
                        class="btn btn-sm btn-outline-light rounded-pill d-flex align-items-center gap-1">
                    <i class="bi bi-plus-lg"></i> Novo chat
                </button>
            </div>

            <div class="d-flex align-items-center justify-content-between px-3 py-2 sidebar-header">
                <h2 class="h6 m-0 text-body">Conversas</h2>
            </div>

            <div id="historyList" class="list-group list-group-flush history-list"></div>

            <template id="historyItemTemplate">
                <div class="list-group-item history-item d-flex align-items-start justify-content-between gap-2">
                    <a href="#" class="history-open text-decoration-none flex-grow-1">
                        <div class="fw-semibold history-title">Novo chat</div>
                        <div class="small text-secondary history-subtitle">Prévia</div>
                    </a>
                    <button class="btn btn-sm btn-ghost history-delete" title="Excluir esta conversa"
                            aria-label="Excluir conversa">
                        <i class="bi bi-trash3"></i>
                    </button>
                </div>
            </template>
        </aside>

        <section class="col-12 col-md-8 col-lg-9 d-flex flex-column chat-pane">
            <header class="chat-header px-3 py-2 d-flex align-items-center justify-content-between">
                <div class="d-flex align-items-center gap-2">
                    <div class="room-dot"></div>
                    <span id="roomTitle" class="text-body">Chat atual</span>
                </div>

                <button id="shareChatBtn" class="btn btn-icon btn-ghost" title="Compartilhar no WhatsApp"
                        aria-label="Compartilhar no WhatsApp">
                    <i class="bi bi-whatsapp"></i>
                </button>
            </header>

            <div id="thread" class="chat-thread flex-grow-1 overflow-auto">
                <div id="threadInner" class="container py-3"></div>
            </div>

            <footer class="composer">
                <form id="chatForm" method="post" class="composer-form container py-3">
                    <div class="composer-box d-flex align-items-end gap-2">
                        <div class="flex-grow-1">
                            <label for="prompt" class="visually-hidden">Mensagem</label>
                            <textarea id="prompt" name="prompt" rows="3" required
                                      class="form-control input-modern"
                                      placeholder="Escreva seu prompt…"></textarea>
                        </div>
                        <div class="composer-actions d-flex gap-2">
                            <button id="clearBtn" type="button" class="btn btn-icon btn-ghost" title="Limpar campo"
                                    aria-label="Limpar campo">
                                <i class="bi bi-eraser"></i>
                            </button>
                            <button id="sendBtn" type="submit" class="btn btn-icon btn-primary-pill" title="Enviar"
                                    aria-label="Enviar">
                                <i class="bi bi-arrow-up"></i>
                            </button>
                        </div>
                    </div>
                </form>
            </footer>
        </section>
    </div>
</main>

<footer class="chat-footer-signature text-center py-3">
    <small>© 2025 <strong>Moris — IA Agent</strong> • Interface por <strong>Daniel Medeiros</strong></small>
</footer>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
<script th:src="@{/js/app.js}"></script>
</body>
</html>
